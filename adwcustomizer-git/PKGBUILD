pkgname=adwcustomizer-git
pkgver=r124.fca1201
pkgrel=1
pkgdesc='Tool for customizing Libadwaita applications and the adw-gtk3 theme. '
arch=('x86_64')
url='https://github.com/ArtyIF/AdwCustomizer'
license=(MIT)
depends=(gtk4 'libadwaita-git>=1.2.alpha' libportal-gtk4 python python-anyascii)
makedepends=(git meson appstream-glib blueprint-compiler desktop-file-utils glib2 gobject-introspection)
optdepends=('adw-gtk3: The theme from libadwaita ported to GTK-3'
            'adw-gtk-theme: LibAdwaita Theme for all GTK3 and GTK4 Apps.')
provides=(adwcustomizer)
conflicts=(adwcustomizer)
source=("git+$url.git"
        'adwcustomizer.patch')
sha512sums=('SKIP'
            '326a310eca86a3caf490e5036709afcf223369ab3875730881edf471be6589d42fc7c72e99e068c6247488558f5501cbe4773113c9acdf707e4e2b21d3999892')

pkgver() {
	cd "$srcdir/AdwCustomizer"
	printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

prepare() {
	cd "$srcdir/AdwCustomizer"
	git apply ../../adwcustomizer.patch
}

build() {
	arch-meson "AdwCustomizer" build
	meson compile -C build
}

package() {
	meson install -C build --destdir "$pkgdir"
}
